#!/usr/bin/env bash

##
## set up a new language
##

AOC_ROOT="$(dirname "$0")/.."

usage() {
    local exitcode=${1:-1}

    echo "usage: aoc-new-lang <language>"
    echo ""
    echo "Sets up a new AoC language."

    exit "${exitcode}"
}

while getopts ":h" opt; do
    case ${opt} in
        h) # help
            usage 0
            ;;

        \?)
            echo "invalid option -${OPTARG}" 1>&2
            usage
            ;;

        :)
            echo "option ${OPTARG} requires an argument" 1>&2
            usage
            ;;

        *) ;;
    esac
done
shift $((OPTIND - 1))

AOC_LANG=$1

# also creates "lang/${AOC_LANG}"
mkdir -p "${AOC_ROOT}/lang/${AOC_LANG}/skeleton"

cp -v "${AOC_ROOT}/.skeleton/.aocrc" "${AOC_ROOT}/.skeleton/Dockerfile" "${AOC_ROOT}/.skeleton/README.md" "${AOC_ROOT}/lang/${AOC_LANG}/"
cp -vR "${AOC_ROOT}/.skeleton/bin" "${AOC_ROOT}/lang/${AOC_LANG}"
